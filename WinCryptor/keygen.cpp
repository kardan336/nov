// Implementation of key generation functions.